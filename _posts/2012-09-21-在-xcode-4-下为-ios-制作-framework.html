---
layout: post
title: 在 xcode 4 下为 iOS 制作 framework
---

<p>写在前面：</p><blockquote><p>通过 Framework 可以在物理上实现 iOS 程序的模块化。</p><p>好处：</p><p> 1、如果模块间接口定义的比较完善，模块化的程序具有很好的可扩展性与内聚性；</p><p> 2、物理上的模块化便于开发过程的管理与测试，尤其是在程序规模相对大。</p><p> 3、如果可以使用胶水语言作为粘合剂，程序可以用很少的代价适应未来的变化。</p><p>不足：</p><p> 1、由于是静态库，应该不会有什么运行时的损失，但是没试验过，不确定。</p><p> 2、资源的加载这部分，不知道会不会占用更多内存，没试验，不确定。</p><p style="font-weight: bold;">1、新建一个静态库工程：</p><p style="font-weight: bold;"></p><p style="font-weight: bold;"></p><p style="font-weight: bold;">2、删除向导所生成工程中的 Target：</p><p>删除目标前工程状态</p><p>删除目标后工程状态</p><p style="font-weight: bold;"></p><p style="font-weight: bold;">3、删除旧目标对应的工程文件夹：</p><p>删除前</p><p>删除后</p><p style="font-weight: bold;"></p><p style="font-weight: bold;">4、删除旧目标对应的编译设置（Product菜单| Edit Scheme命令）：</p><p style="font-weight: bold;"></p><p>点击左下角的 Manage Schemes 按钮：</p><p>选中旧的 Scheme，点击左下角的减号删除：</p><p>删除完成后，点击 OK 返回。</p><p style="font-weight: bold;"></p><p>5、增加一个新目标。点击 &ldquo;Add Target&rdquo;：</p><p>在弹出的对话框中选择 Mac OS X 下的 Bundle：</p><p>如上图，给库取一个名字，保持默认的 Framework（CoreFoundation），然后点击 Finish。</p><p style="font-weight: bold;"></p><p>6、修改新目标的工程设置。选中 TARGETS 中对应的目标， Build Settings 页：</p><p style="font-weight: bold;"></p><p>在 Architectures 下，将&rdquo;Base SDK&rdquo;改为&rdquo;Latest iOS&rdquo;,然后将 &ldquo;Architectures&rdquo; 改为 &ldquo;Standard&rdquo;：</p><p style="font-weight: bold;"></p><p>在 Deployment 下，将 &ldquo;Mac OS X Deployment Target&rdquo;改为&rdquo;Compiler Default&rdquo;，将 &ldquo;Targeted Device Family&rdquo;改为需要的，此处改成了&rdquo;iPhone/iPad&rdquo;,同时可以根据需要修改 &ldquo;iOS Deployment Target&rdquo;，此处改为了 &ldquo;iOS 3.0&rdquo;:</p><p style="font-weight: bold;"></p><p>在 Linking 中，将 &ldquo;Dead Code Stripping&rdquo; 改为 &ldquo;NO&rdquo;，将 &ldquo;Link with Standard Libraries&rdquo; 改为 &ldquo;NO&rdquo;，将 &ldquo;Mac-O Type&rdquo; 改为 &ldquo;Relocatable Object File&rdquo;：</p><p style="font-weight: bold;"></p><p>在 Packaging 中，将 &ldquo;Wrapper Extention&rdquo; 改为&ldquo;framework&rdquo;:</p><p style="font-weight: bold;"></p><p style="font-weight: bold;"></p><p style="font-weight: bold;"></p><p>7、修改目标的 Info。点击 Info：</p><p>将 &ldquo;Bundle OS Type Code&rdquo; 改为 &ldquo;FMWK&rdquo;（Framework 的意思）：</p><p style="font-weight: bold;"></p><p style="font-weight: bold;"></p><p style="font-weight: bold;">8、修改预编译头：</p><p>修改前</p><p>修改后</p><p style="font-weight: bold;"></p><p style="font-weight: bold;">9、向工程中添加一个类（ViewController 与 Xib）：</p><p>结果如下：</p><p style="font-weight: bold;"></p><p style="font-weight: bold;"></p><p style="font-weight: bold;"></p><p>10、导出相关文件。选中 Target，点击 Build Phases：</p><p>点击右下角的 &ldquo;Add Build Phase&rdquo;：</p><p>在弹出的菜单中选择 &ldquo;Add Copy Headers&rdquo;，添加完成后，展开 &ldquo;Copy Headers&rdquo;：</p><p>点击加号：</p><p>选中需要暴露的头文件，此处我们选择 &ldquo;ClassA.h&rdquo;:</p><p>点击 Add 按钮完成添加：</p><p>此时，我们看到导出的文件在 Project 下，这样是不能暴露给别人使用的，将其拖动到 Public 下：</p><p>关于 Framework 的详细说明参考苹果的在线文档:http://developer.apple.com/library/mac/#documentation/MacOSX/Conceptual/BPFrameworks/Frameworks.html#//apple_ref/doc/uid/10000183-SW1</p><p style="font-weight: bold;"></p><p style="font-weight: bold;"></p><p style="font-weight: bold;">11、编译项目，查看结果：</p><p style="font-weight: bold;"></p><p style="font-weight: bold;"></p><p style="font-weight: bold;"></p><p style="font-weight: bold;">12、这是手工制作 Framework 的方法，网上有人制作了工程模版，可以直接生成 Framework 工程：</p><p style="font-weight: bold;">https://github.com/kstenerud/iOS-Universal-Framework</p></blockquote>

了解破碎机常识：<a href='http://www.crushermillsupplier.com'>crusher mill supplier</a>