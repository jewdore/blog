---
layout: post
title: (转)ERROR: Failed to build gem native extension
---

<p style="margin: 1em 0px; padding: 0px;">　　这几天本人在Window server 2003(工作机)中搭建Cucumber环境时(可以看我的另一篇文章：http://www.cnblogs.com/puresoul/archive/2011/11/18/2254407.html)，当运行gem install cucumber时，报错：ERROR: Failed to build gem native extension.到处搜寻未果，最后在这里找到了答案：https://github.com/oneclick/rubyinstaller/wiki/Troubleshooting，特此转来。本人就不做翻译了，有需要的朋友尽管拿去，原文如下：</p><p style="margin: 1em 0px; padding: 0px;">　　You&rsquo;ve installed both RubyInstaller and DevKit followingthe instructionsbut during gem installation, you receive a message like this:</p><pre>C:\devkit&gt;gem install rdiscount --platform=rubyTemporarily enhancing PATH to include DevKit...Building native extensions.  This could take a while...ERROR:  Error installing rdiscount:       ERROR: Failed to build gem native extension.C:/ruby/bin/ruby.exe extconf.rbC:/ruby/bin/ruby.exe: No such file or directory -- extconf.rb(LoadError)</pre><p style="margin: 1em 0px; padding: 0px;">Or sometimes just this:</p><pre><code style="background-color: transparent; margin: 0px; font: 13px 'Bitstream Vera Sans Mono', Courier, monospace; border-top-left-radius: 3px 3px; border-top-right-radius: 3px 3px; border-bottom-right-radius: 3px 3px; border-bottom-left-radius: 3px 3px; border: #dedede 1px; padding: 0px;">ERROR: Error installing rdiscount: </code></pre><pre><code style="background-color: transparent; margin: 0px; font: 13px 'Bitstream Vera Sans Mono', Courier, monospace; border-top-left-radius: 3px 3px; border-top-right-radius: 3px 3px; border-bottom-right-radius: 3px 3px; border-bottom-left-radius: 3px 3px; border: #dedede 1px; padding: 0px;">ERROR: Failed to build gem native extension. </code></pre><pre><code style="background-color: transparent; margin: 0px; font: 13px 'Bitstream Vera Sans Mono', Courier, monospace; border-top-left-radius: 3px 3px; border-top-right-radius: 3px 3px; border-bottom-right-radius: 3px 3px; border-bottom-left-radius: 3px 3px; border: #dedede 1px; padding: 0px;">C:/Ruby187/bin/ruby.exe extconf.rb</code></pre><p style="margin: 1em 0px; padding: 0px;">This has been reported to our grouphereandhere.</p><p style="margin: 1em 0px; padding: 0px;">After a long back and forth investigation, we found two possible causes for this issue:<code style="background-color: #f8f8f8; margin: 0px; font: 13px 'Bitstream Vera Sans Mono', Courier, monospace; border-top-left-radius: 3px 3px; border-top-right-radius: 3px 3px; border-bottom-right-radius: 3px 3px; border-bottom-left-radius: 3px 3px; border: #dedede 1px solid; padding: 0px;">COMSPEC</code>environment variable (scenario A) and AutoRun registry setting (scenario B), both described below:</p><p style="margin: 1em 0px; padding: 0px;"><em style="margin: 0px; padding: 0px;"><strong style="margin: 0px; padding: 0px;">Scenario A</em></p><p style="margin: 1em 0px; padding: 0px;">Using a command prompt, invoke the following command:</p><pre>SET COMSPEC</pre><p style="margin: 1em 0px; padding: 0px;">If in the output you see something different than<code style="background-color: #f8f8f8; margin: 0px; font: 13px 'Bitstream Vera Sans Mono', Courier, monospace; border-top-left-radius: 3px 3px; border-top-right-radius: 3px 3px; border-bottom-right-radius: 3px 3px; border-bottom-left-radius: 3px 3px; border: #dedede 1px solid; padding: 0px;">cmd.exe</code>as value for that variable, then please adjust it to use<code style="background-color: #f8f8f8; margin: 0px; font: 13px 'Bitstream Vera Sans Mono', Courier, monospace; border-top-left-radius: 3px 3px; border-top-right-radius: 3px 3px; border-bottom-right-radius: 3px 3px; border-bottom-left-radius: 3px 3px; border: #dedede 1px solid; padding: 0px;">cmd.exe</code></p><p style="margin: 1em 0px; padding: 0px;">Some tools might change your command processor command, which interferes with Ruby invoking child processes.</p><p style="margin: 1em 0px; padding: 0px;">Change that and try to install the gem again.</p><p style="margin: 1em 0px; padding: 0px;"><em style="margin: 0px; padding: 0px;"><strong style="margin: 0px; padding: 0px;">Scenario B</em></p><p style="margin: 1em 0px; padding: 0px;">If the problem persist, invoke the following commands in the same command prompt:</p><pre>REG QUERY "HKCU\Software\Microsoft\Command Processor"REG QUERY "HKLM\Software\Microsoft\Command Processor"</pre><p style="margin: 1em 0px; padding: 0px;">Execute each line individually. Once you run it, will see something like this:</p><pre>HKEY_CURRENT_USER\Software\Microsoft\Command Processor    CompletionChar    REG_DWORD    0x9    DefaultColor    REG_DWORD    0x0    EnableExtensions    REG_DWORD    0x1    PathCompletionChar    REG_DWORD    0x9</pre><p style="margin: 1em 0px; padding: 0px;">The columns of information are<em style="margin: 0px; padding: 0px;">Key</em>,<em style="margin: 0px; padding: 0px;">Type</em>and<em style="margin: 0px; padding: 0px;">Value</em>. If you see a key named<code style="background-color: #f8f8f8; margin: 0px; font: 13px 'Bitstream Vera Sans Mono', Courier, monospace; border-top-left-radius: 3px 3px; border-top-right-radius: 3px 3px; border-bottom-right-radius: 3px 3px; border-bottom-left-radius: 3px 3px; border: #dedede 1px solid; padding: 0px;">AutoRun</code>, there is a chance this is the culprit of the error you&rsquo;re receiving.</p><p style="margin: 1em 0px; padding: 0px;"><code style="background-color: #f8f8f8; margin: 0px; font: 13px 'Bitstream Vera Sans Mono', Courier, monospace; border-top-left-radius: 3px 3px; border-top-right-radius: 3px 3px; border-bottom-right-radius: 3px 3px; border-bottom-left-radius: 3px 3px; border: #dedede 1px solid; padding: 0px;">AutoRun</code>interferes with Ruby messing with child process executing and by result, affecting gem installation. Please remove it with the following command:</p><pre>REG DELETE "HKCU\Software\Microsoft\Command Processor" /v AutoRun</pre><p style="margin: 1em 0px; padding: 0px;">Once you&rsquo;re done, try opening a new command prompt and executing gem installation again.</p>

了解破碎机常识：<a href='http://www.crushermillsupplier.com'>crusher mill supplier</a>