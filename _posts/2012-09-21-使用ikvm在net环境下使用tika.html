---
layout: post
title: 使用IKVM在.Net环境下使用Tika
---

<p>原文地址：http://www.dovetailsoftware.com/blogs/kmiller/archive/2010/07/02/using-the-tika-java-library-in-your-net-application-with-ikvm?utm_source=feedburner&amp;utm_medium=feed&amp;utm_campaign=Feed:+KevinMiller+(Kevin+Miller)</p>Using the Tika Java Library In Your .Net Application With IKVM<p>This may sound scary and heretical but did you know it is possible to leverage Java libraries from .Net applications with no TCP sockets or web services getting caught in the crossfire? Let me introduce you to IKVM, which is frankly magic:</p><blockquote><p>IKVM.NET is an implementation of Java for Mono and the Microsoft .NET Framework. It includes the following components:</p>A Java Virtual Machine implemented in .NETA .NET implementation of the Java class librariesTools that enable Java and .NET interoperability</blockquote><p>Using IKVM we have been able to successfully integrate our Dovetail Seeker search application with the Tika text extraction library implemented in Java. With Tika we can easily pull text out of rich documents from many supported formats. Why Tika? Because there is nothing comparable in the .Net world as Tika.</p><p>This post will review how we integrated with Tika. If you like code you can find this example in a repo up on Github.</p>Compiling a Jar Into An Assembly<p>First thing, we need to get our hands on the latest version of Tika. I downloaded and built the Tika source using Maven as instructed. The result of this was a few jar files. The one we are interested in is tika-app-x.x.jar which has everything we need bundled into one useful container.</p><p>Next up we need to convert this jar we&rsquo;ve built to a .Net assembly. Do this using ikvmc.exe.</p><blockquote><p>tika\build&gt;ikvmc.exe -target:library tika-app-0.7.jar</p></blockquote><p>Unfortunately, you will see tons of troublesome looking warnings but the end result is a .Net assembly wrapping the Java jar which you can reference in your projects.</p>Using Tika From .Net<p>IKVM is pretty transparent. You simply reference the the Tika app assembly and your .Net code is talking to Java types. It is a bit weird at first as you have Java versions of types and .Net versions. Next you&rsquo;ll want to make sure that all the dependent IKVM runtime assemblies are included with your project. Using Reflector I found that the Tika app assembly referenced a lot of IKVM assemblies which do not appear to be used. I had to figure out through trial and error which assemblies where not being touched by the rich document extractions being done. If need be you could simple include all of the referenced IKVM assemblies with your application. Below I have done the work for you and eliminated all references to all the IKVM assemblies which appear to be in play.</p><p>16 assemblies down to 5. A much smaller deployment.</p>Using Tika<p>To do some text extraction we&rsquo;ll ask Tika, very nicely, to parse the files we throw at it. For my purposes this involved having Tika automatically determine how to parse the stream and extract the text and metadata about the document.</p><code class="csharp keyword">public</code> <code class="csharp plain">TextExtractionResult Extract(</code><code class="csharp keyword">string</code> <code class="csharp plain">filePath) </code>

了解破碎机常识：<a href='http://www.crushermillsupplier.com'>crusher mill supplier</a>