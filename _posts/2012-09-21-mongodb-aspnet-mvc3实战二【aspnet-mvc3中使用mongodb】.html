---
layout: post
title: MongoDB +ASP.NET MVC3实战二【ASP.NET MVC3中使用MongoDB】
---

<style>.h3{padding: 3px;color: white;background-color: #a5a5a5;}.code{font-family: "Courier New", "Times New Roman",times,sans-serif;border-style: dashed;border-left: solid 5px #6ce26c;border-width: 1px 1px 1px 5px;border-color: #9cf #9cf #9cf #6ce26c;padding-left: 5px;}</style>  <p>有了之前对MongoDB的了解，接下来我们开始在ASP.NET MVC3中使用它了。我找了两个，一个是从官方的Driver下载编译之后应该有两个dll文件，分别是MongoDB.Bson.dll和MongoDB.Driver.dll。具体怎么用可以去搜索一下。</p> <p>另一个是https://github.com/samus/mongodb-csharp/downloads，本示例使用后者，编译这个项目就能得到文件名：MongoDB.dll 具体用法可以参考下载Solution中的Sample。</p> <p>具体操作请各位直接看代码吧，最后也附有源码下载。</p> <p>下面分别是在MVC3中对【频道】的增、删、改、查操作</p> <h3 class="h3">首先定义 Channel 实体<pre class="code"><p>public partial class Channel { public Guid ChannelId {get ;set ; }</p><p> [Required(ErrorMessage = "请输入频道名称！")] public string ChannelName { get ;set ; }</p><p> [Required(ErrorMessage = "请输入频道FMS路径！")] public string FMSPath{ get ;set ; }</p><p> public int VideoType { get ;set ;}</p><p> public int ChannelStatus {get ;set ; }</p><p> [Required(ErrorMessage = "请输入流名称！")] public string StreamName { get ;set ;}</p><p> }</p></pre><h3 class="h3">频道列表<pre class="code"><p>public static List&lt;Channel&gt; GetChannel()</p><p>{</p><p> using (Mongo mg = newMongo(DBcon._connectionString))</p><p> { </p><p> mg.Connect(); </p><p> var db = mg.GetDatabase(DBcon._channel);</p><p> var list = db.GetCollection&lt;Channel&gt;();</p><p> var query = (from c in list.Linq() select c).ToList&lt;Channel&gt;();</p><p> return query;</p> }}</pre><h3 class="h3">新增频道<pre class="code"><p>public static void AddChannel(Channel model)</p><p>{ using (Mongo mg = new Mongo(DBcon._connectionString)) { mg.Connect(); var db = mg.GetDatabase(DBcon._channel); var list = db.GetCollection&lt;Channel&gt;(); list.Insert(model); }}</p></pre><h3 class="h3">更新频道<pre class="code"><p>public static void UpdateChannel(Channel model)</p><p>{using (Mongo mg = new Mongo(DBcon._connectionString)) { mg.Connect(); var db = mg.GetDatabase(DBcon._channel); var list = db.GetCollection&lt;Channel&gt;(); list.Update(model, c =&gt; c.ChannelId == model.ChannelId); }</p><p>}</p></pre><h3 class="h3">删除频道<pre class="code"><p>public static void DeleteChannel(Guid cid){ using (Mongo mg = new Mongo(DBcon._connectionString)){mg.Connect();var db = mg.GetDatabase(DBcon._channel);var list = db.GetCollection&lt;Channel&gt;();list.Remove(c =&gt; c.ChannelId == cid);}</p><p>}</p></pre><p>MVC3+MongoDB源码下载</p>

了解破碎机常识：<a href='http://www.crushermillsupplier.com'>crusher mill supplier</a>