---
layout: post
title: 使用Django开发一个图书管理系统----04.通过admin模块管理我们的app和model
---

<p>BOOKMS是一个公司内部的图书管理系统。BOOKMS的后台管理主要使用Django的admin模块。 <p>本系列用多次迭代方法，逐步实现一个图书管理系统BOOKMS。 <p>本文主要介绍app的后台管理和用django-groundwork 生成前台CRUD。 <p> 一.将自己的models加入到admin的管理 <p>上一回我们可以看到后台的界面了，但细心的你一定发现了里面没有我们要的book模型的管理。下面让我们把自定义的book模型加入到管理中，这样我们就能够通过这个漂亮的界面添加修改删除数据库中的对象了。 <p>在bookapp的目录下创建一个文件admin.py，然后输入以下代码：<pre class="brush: py; auto-links: true; collapse: false; first-line: 1; gutter: true; html-script: false; light: false; ruler: false; smart-tabs: true; tab-size: 4; toolbar: true;">from django.contrib import adminfrom bookapp.models import *class BookAdmin(admin.ModelAdmin):passadmin.site.register(Book)</pre><p>这些代码通知管理工具为这些模块逐一提供界面。然后我们重新运行一下再次访问http://127.0.0.1:8000/admin/，这回终于看见我们的模块和模型了。<p><p>这里有个小BUG要修改一下，打开python安装目录lib子目录里的site.py找到setencoding（）方法<pre class="brush: py; auto-links: true; collapse: false; first-line: 1; gutter: true; html-script: false; light: false; ruler: false; smart-tabs: true; tab-size: 4; toolbar: true;">if 0:# Enable to support locale aware default string encodings.import localeloc = locale.getdefaultlocale()if loc[1]:encoding = loc[1]</pre><p>if 0改为if 1，如果忽略此步下面添加里输入有中文会在保存时候出错<p>我们来添加2本图书，数据来源自豆瓣。<p><p><p>这里是后台的管理界面，这时我们基本可以对我们的模型进行全部的增删改查操作了。关于admin模块的详细修改和细化，后面详细介绍。二.前台功能生成<p>后台是可以使用了，但我们的前台还没有呢，当然作为一个懒人我们自己不会去一点点写，django-groundwork 会帮我们生成最基本的CRUD。<p>首先到https://github.com/madhusudancs/django-groundwork/downloads下载zip包。如果有安装git直接git获取。<p>下载的包解开后把django-groundwork文件夹复制到我们的project中，然后在setting.py里加入这个app<pre class="brush: py; auto-links: true; collapse: false; first-line: 1; gutter: true; html-script: false; light: false; ruler: false; smart-tabs: true; tab-size: 4; toolbar: true;">INSTALLED_APPS = ('django.contrib.auth','django.contrib.contenttypes','django.contrib.sessions','django.contrib.sites','django.contrib.messages','django.contrib.staticfiles',# Uncomment the next line to enable the admin:'django.contrib.admin',# Uncomment the next line to enable admin documentation:# 'django.contrib.admindocs','BOOKMS.bookapp','django-groundwork',)</pre><p>接着我们还是盗命令行然后进入到我们的project目录运行：<p>python manage.py help<p>这里我们会发现多了一个groundwork命令。<p>接下来我们来为bookapp的Book生成页面：<p>python manage.py groundwork bookapp Book<p>输入Y确认，它就帮我们生成了。<p>这是运行项目并访问http://127.0.0.1:8000/bookapp/book/list/<p><p>三。groundwork 究竟帮我们干了什么<p>偷懒是不好的，我们起码 要知道groundwork 帮我们都干了什么，下面简单说明。<p>首先看bookms/urls.py:<p>urlpatterns += patterns ('',(r'^bookapp/', include('bookapp.urls')),)<p>这里帮我们加入一个路由，url里bookapp开头的都让我们自己的模块去处理。<p>然后我们在看看bookms/bookapp/urls.py：<p> <p>将CRU(没有<pre class="brush: py; auto-links: true; collapse: false; first-line: 1; gutter: true; html-script: false; light: false; ruler: false; smart-tabs: true; tab-size: 4; toolbar: true;">urlpatterns = patterns('',(r'book/create/$', create_book),(r'book/list/$', list_book ),(r'book/edit/(?P&lt;id&gt;[^/]+)/$', edit_book),(r'book/view/(?P&lt;id&gt;[^/]+)/$', view_book), )</pre><p>D)都添加了隐射。<p>视图都定义在了bookms/bookapp/views.py这里不再多说。

了解破碎机常识：<a href='http://www.crushermillsupplier.com'>crusher mill supplier</a>