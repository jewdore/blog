---
layout: post
title: coffe-script
---

<p>GitHub上好多项目都是用coffee-script写的，尤其是运行于Nodejs下的项目，也没太在意，一直没有仔细看看coffee。我学习编程主要还是兴趣驱动，我之前对OT（google wave，etherpad等实时编辑器的核心）很感兴趣，这个项目ShareJs，用coffee实现了类似etherpad的功能，我要看代码，必须了解下coffee了</p><p>1.coffee-script在线测试</p><p>如果安装了Nodejs，直接在命令行下面跑最好了，这里提供了一个简单的线上测试环境</p><p>http://jashkenas.github.com/coffee-script/单击TRY COFFEESCRIPT</p><p>2.语法</p><p>coffee最终是转化为js执行的，不去关注转化后的代码，那么如何写coffee-script呢？</p><p>函数定义：</p><pre class="brush:python;">hi = (a,b) -&gt;  alert(a+" say to:"+b+",hello!");</pre><p>右边会自动生成编译后真正执行的javascript（后面不再列出）</p><pre class="brush:python;">var hi;hi = function(a, b) {  return alert(a + " say to:" + b + ",hello!");};</pre><p>函数调用:不用括号</p><pre class="brush:python;">hi "tom","Lily"</pre><p>字符</p><p>内插字符:</p><pre class="brush:python;">name = "tom"s = "hi #{name}"alert name</pre><pre class="brush:python;">/*跨越多行的字符，类似Python的语法*/name = "tom,john,kinas"s = "hi #{name}"alert name</pre><p>定义数组</p><pre class="brush:python;">a = [1,2,3,4];/*第一种方法定义*/b = [ i for i in [1..10]];/*第二种方法,用 &lsquo;..&rsquo; 表示范围*/alert a;alert b;</pre><p>遍历数组</p><pre class="brush:python;">a = [1,2,3,4];b = [ i for i in a];/*很自然的遍历方式*/alert b;</pre><p>还可以调用函数:</p><pre class="brush:python;">[alert i for i in a]</pre><pre class="brush:python;"></pre><p>this：在coffe没有显示的this,@代替之</p><pre class="brush:python;">sayHello (name)-&gt;  @name = name  @say -&gt; alert name</pre><p>对应的javascript：</p><pre class="brush:javascript;">sayHello(function(name) {  this.name = name;  return this.say(function() {    return alert(name);  });});</pre><p>一行函数调用，带判断</p><pre class="brush:python;">alert "I knew it!" if elvis?</pre><p>coffee-script 的继承(摘自这里)</p><pre class="brush:python;">class Animal    constructor: (@name) -&gt;    move: (meters) -&gt;        alert @name + " moved " + meters + "m."class Snake extends Animal    move: -&gt;        alert "Slithering..."        super 5</pre><p>观察生成的javascript，可以窥探其继承的实现</p><pre class="brush:javascript;collapse:true;">for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; }  function ctor() { this.constructor = child; }  ctor.prototype = parent.prototype;  child.prototype = new ctor;  child.__super__ = parent.prototype;  return child;};Animal = (function() {  function Animal(name) {    this.name = name;  }  Animal.prototype.move = function(meters) {    return alert(this.name + " moved " + meters + "m.");  };  return Animal;})();Snake = (function() {  __extends(Snake, Animal);  function Snake() {    Snake.__super__.constructor.apply(this, arguments);  }  Snake.prototype.move = function() {    alert("Slithering...");    return Snake.__super__.move.call(this, 5);  };  return Snake;})();</pre>

了解破碎机常识：<a href='http://www.crushermillsupplier.com'>crusher mill supplier</a>