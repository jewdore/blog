---
layout: post
title: [转]如何在 node.js 執行 UglifyJS 對 JavaScript 進行壓縮或美化
---

<p>前一篇文章介紹了如何在 Cygwin 環境下安裝 node.js，我的原始目的只是為了要能正常執行UglifyJS 而已，原本想說在 node.js 寫的程式都是 JavaScript 應該不會有什麼問題吧，結果是目前版本的 UglifyJS 還有點小問題導致無法正常執行，解決方式也很簡單，以下是 UglifyJS 的安裝與使用說明。 </p><p>下載 UglifyJS 最新版原始碼 </p><p>env GIT_SSL_NO_VERIFY=true git clone https://github.com/mishoo/UglifyJS.git </p><p> </p><p>備註：如果不加上 env GIT_SSL_NO_VERIFY=true 這段環境變數的話，很可能會導致 git 在 clone 原始碼的時候發生 SSL 憑證發生問題的錯誤，錯誤訊息為：error: SSL certificate problem, verify that the CA cert is OK. 如下圖示。 </p><p> </p><p>完整的解決辦法可參考 HTTPS github access 的解答，或執行以下指令： </p>cd /usr/ssl/certs wget http://curl.haxx.se/ca/cacert.pem cat cacert.pem | awk 'split_after==1{n++;split_after=0} /-----END CERTIFICATE-----/ {split_after=1} {print &gt; "cert" n ".pem"}' rm -f cacert.pem c_rehash<p>進入 UglifyJS 的目錄 </p><p>cd UglifyJS/ </p><p>測試執行 ./bin/uglifyfs </p><p>./bin/uglifyfs </p><p>在預設的原始碼之下，不管在 Linux 或 Cygwin 下都會發生 Cannot find module 'ulify-js' 的錯誤： </p><p> </p><p>解決的方式有 3 種： </p><p>1. 修改 bin/uglifyjs 這支 UglifyJS 主程式，並加入程式所在的相對路徑，讓 bin/uglifyjs 在執行時能找到對應的模組。如下圖示： </p><p> </p><p>2. 將 UglifyJS 所有模組都複製到 node 預設的 ~/.node_libraries 目錄下 ( 僅自己能用 ) </p><p>請在 UglifyJS 所在目錄執行以下 3 行指令即可 </p><p>mkdir ~/.node_libraries </p><p>cp -a lib/ ~/.node_libraries/ </p><p>cp index.js ~/.node_libraries/uglify-js.js </p><p> </p><p>3. 將 UglifyJS 所有模組都複製到 node 預設的 /usr/local/lib/node 目錄下 ( 讓所有使用者都能用 ) </p><p>請在 UglifyJS 所在目錄執行以下 2 行指令即可 </p><p>mkdir /usr/local/lib/node/uglify-js </p><p>cp -a index.js lib/ /usr/local/lib/node/uglify-js/ </p><p>將 uglifyfs 主程式複製到 /usr/local/bin 目錄下 </p><p>cp bin/uglifyjs /usr/local/bin/uglifyjs </p><p>UglifyJS 安裝完成！ </p><p>UglifyJS 的基本使用方式 </p><p>1. 壓縮 JavaScript 程式碼 </p><p>uglifyjs example.js &gt; example.min.js </p><p> </p><p>2. 美化 JavaScript 程式碼 </p><p>uglifyjs -b example.min.js &gt; example.js </p>

了解破碎机常识：<a href='http://www.crushermillsupplier.com'>crusher mill supplier</a>