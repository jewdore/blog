---
layout: post
title: tslib編译和安装
---

<p>系统：Ubuntu 10.4</p><p>编译工具：arm-linux-gcc 4.5.1 (ctng-1.8.1-FA)</p><p>编译目标：tslib </p><p>（1）安装 arm-linux-gcc 4.5.1，(这个不讲了)</p><p>（2）将kergoth-tslib-1.0-106-gf6c499a.tar.gz解压到任一目录(下载来自https://github.com/kergoth/tslib)</p><p>（3）进入kergoth-tslib-f6c499a目录kergoth-tslib-f6c499a</p><p>（4）安装库支持：</p><blockquote style="margin-right: 0px;" dir="ltr"><p>sudoapt-getinstallautoconfautomakelibtool</p></blockquote><p dir="ltr">（5）export PREFIX=/opt/tslib 设置目标位置</p><p dir="ltr">（6）./autogen.sh 用于生成configure脚本</p><p dir="ltr">（7）echo "ac_cv_func_malloc_0_nonnull=yes" &gt;arm-linux.cache 产生一个cache文件arm-linux.cache，欺骗configure</p><p dir="ltr">（8）CC=arm-linux-gcc ./configure --host=arm-linux --prefix=/opt/tslib/ --cache-file=arm-linux.cache</p><p dir="ltr">（9）make</p><p dir="ltr">（10）make install</p><p dir="ltr"> 编译成功后在目标位置产生/bin、/etc、/include、/lib 4个文件夹（11）修改/opt/tslib/etc/ts.conf 文件，删除其中内容，改为</p><p dir="ltr"> module_raw input</p><p dir="ltr"> module pthres pmin=1 module variance delta=30 module dejitter delta=100 module linear</p><blockquote style="margin-right: 0px;" dir="ltr"><p dir="ltr">第一行是tslib从linux的输入设备读取数据时需要用到的模块，这里指定的模块为input，具体需要用到哪个模块，需要参考其他数据。第二行的pthres为Tslib提供的触摸屏灵敏度门槛插件。第三行的variance为Tslib提供的触摸屏滤波算法插件。第四行的dejitter为Tslib 提供的触摸屏去噪算法插件。第五行linear为Tslib提供的触摸屏坐标变换插件。</p></blockquote><p dir="ltr" align="left">（12）将/opt下的tslib文件夹拷贝到arm文件系统的/opt下</p><p dir="ltr" align="left">（13）设置环境变量脚本tslib.sh</p><p dir="ltr" align="left"> #!/bin/sh export TSLIB_ROOT=/opt/tslib export TSLIB_TSDEVICE=/dev/input/event0 export TSLIB_CALIBFILE=$TSLIB_ROOT/etc/pointercalexport TSLIB_CONFFILE=$TSLIB_ROOT/etc/ts.confexport TSLIB_PLUGINDIR=$TSLIB_ROOT/lib/ts export TSLIB_CONSOLEDEVICE=/dev/tty export TSLIB_FBDEVICE=/dev/fb0 //根据你的实际情况设置</p><p dir="ltr" align="left">（14）启动arm板，命令行下执行脚本</p><p dir="ltr" align="left"> source tslib.sh</p><p dir="ltr" align="left">（15）校准触摸屏</p><p dir="ltr" align="left"> cd /opt/tslib/bin</p><p dir="ltr" align="left"> ./ts_calibrate</p><p dir="ltr" align="left"> 会出现校准画面，完成后生成pointercal文件</p><p dir="ltr" align="left">（16）链接</p><p dir="ltr" align="left"> ln -s /opt/tslib/etc/pointercal /etc/pointercal</p><p dir="ltr" align="left">至此，tslib1.4移植完成</p>

了解破碎机常识：<a href='http://www.crushermillsupplier.com'>crusher mill supplier</a>