---
layout: post
title: git remote/client 学习笔记
---

<p>搞了两天git,尝试了几种git server的创建方法，最简单的就是apache http,最后还是选定使用SSH，因为安全、操作方便、可创建账号、client必须上传public key.</p><p>了解更多：http://www.jedi.be/blog/2009/05/06/8-ways-to-share-your-git-repository/</p><p>http://stackoverflow.com/questions/315911/git-for-beginners-the-definitive-practical-guide</p><p>git手册：http://kernel.org/pub/software/scm/git/docs/</p><p>注：本文基于Mac OSX SL环境。</p><p>一、安装git并配置用户名和密码</p><p>已安装MacPorts的可以通过命令行安装：</p><p>$ sudo port install git-core</p><p>或者安装gitgui: http://code.google.com/p/git-osx-installer/</p><p>配置全局用户名和密码：</p><p>$ git config --global user.name "Elf Sundae"</p><p>$ git config --global user.email youruser@email.com</p><p>上述操作会在你的home directory创建 ~/.gitconfig文件。查看：</p><p>$ git config --global --list</p><p>你也可以在单独项目中设置特定的user.name和user.email，例如工作邮箱和私人邮箱区分开，方法是在remote时git config，不加--global即可。</p><p>二、服务器配置</p><p>1.设置服务器为静态ip,例如192.168.18.188</p><p>2.如果需要在外网访问，在路由器添加端口映射，SSH一般用22，可以在路由器映射一个端口(如12345)到服务器的22端口。再申请一个动态DNS解析服务(http://www.dyndns.com/)</p><p>3.在服务器创建一个standard的账户用于远程SSH登陆，名字随便起，并设置密码。你可以为每个客户端创建一个账户，但是没多大意义。</p><p>4.开启ssh登陆：</p><p>5.配置sshd_config:（需要管理员权限）</p><p><tt>$ sudo open /etc/sshd_config</tt></p><th>找到这行</th><th>改成这样</th><tt>#PermitRootLogin yes</tt><tt>PermitRootLogin no</tt><tt>#PasswordAuthentication no</tt><tt>PasswordAuthentication no</tt><tt>#ChallengeResponseAuthentication yes</tt><tt>ChallengeResponseAuthentication no</tt><tt>#UsePAM yes</tt><tt>UsePAM no</tt><p>至此，服务器地址类似这样：ssh://[username]@ipAddressOrDomain/path/to/git 例如：</p><p>ssh://git@192.168.18.188</p><p>ssh://git@example.com:12345</p><p>6. 设置PATH</p><p>log out管理员账户，log in git账户，</p><pre class="sh">echo 'export PATH="$PATH:/usr/local/git/bin/"' &gt;&gt; ~/.bashrc</pre><p>三、客户端安装git并获取Public key</p><p class="sh">cdmkdir -p .sshcd .sshssh-keygen -f elfmacbook_git_key -t rsa -qssh-add -K elfmacbook_git_keycp elfmacbook_git_key.pub ~/Desktop其中passphrase可输可不输，但输了比较安全，且一定要记下，在OSX下在第一次使用时可以勾选记忆passphrase到系统keychain中。</p><p class="sh">如果你创建pub后就要发给服务端(见下四)，不用复制到桌面了，直接拷贝到剪切板：</p><p class="sh">$ cat ~/.ssh/elfmacbook_git_key.pub | pbcopy</p><p class="sh"><em>或者：（http://help.github.com/mac-set-up-git/）</em></p><p class="sh">$ cd ~/.ssh$ ssh-keygen -t rsa -C "your_email@email.com" （询问保存路径时直接敲回车）输入passphrase$ cat id_rsa.pub | pbcopy</p><p class="sh">四、客户端提交public key到服务器，写入服务器的authorized_keys。</p><p class="sh">每个客户端都要执行第三步，将获取到的pub文件用记事本打开将内容提交到服务器（只有一行），服务器端用支持不换行的文本编辑器(如Smultron)打开/Users/git/authorized_keys,写入客户端的pub key。每个客户机占一行。</p><p class="sh">或者命令行：</p><p class="sh"><code>$ echo "[public key string]" &gt; /Users/git/.ssh/authorized_keys</code></p><p class="sh">完成后重启服务器。</p><p class="sh">五、测试</p><p class="sh">ssh到git server 或在服务端git账户登陆</p><p class="sh">$ ssh git@192.168.18.188</p><p class="sh">$ cd</p><p class="sh">$ mkdir Mytest.git</p><p class="sh">$ cd Mytest.git</p><p class="sh">$ git init --bare</p><p class="sh">$ exit</p><p>Add the remote repository and push:</p><p>$ cd ~/Desktop/MyTestProject</p><p>$ git remote add origin ssh://git@192.168.18.188/Users/git/Mytest.git</p><p>$ git push origin master</p>

了解破碎机常识：<a href='http://www.crushermillsupplier.com'>crusher mill supplier</a>