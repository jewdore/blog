---
layout: post
title: js call函数
---

<p>在分析jquery源码时，遇到each函数体里的一段代码：</p>  <pre><pre style="background-color: #95f2a3; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 14px">  1: if ( isObj ) {</pre><pre style="background-color: #9ca6fa; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 14px">  2:     for ( name in object ) {</pre><pre style="background-color: #95f2a3; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 14px">  3:         if ( callback.call( object[ name ], name, object[ name ] ) === false ) {</pre><pre style="background-color: #9ca6fa; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 14px">  4:             break;</pre><pre style="background-color: #95f2a3; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 14px">  5:         }</pre><pre style="background-color: #9ca6fa; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 14px">  6:     }</pre><pre style="background-color: #95f2a3; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 14px">  7: } else {</pre><pre style="background-color: #9ca6fa; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 14px">  8:     for ( ; i &lt; length; ) {</pre><pre style="background-color: #95f2a3; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 14px">  9:         if ( callback.call( object[ i ], i, object[ i++ ] ) === false ) {</pre><pre style="background-color: #9ca6fa; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 14px"> 10:             break;</pre><pre style="background-color: #95f2a3; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 14px"> 11:         }</pre><pre style="background-color: #9ca6fa; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 14px"> 12:     }</pre><pre style="background-color: #95f2a3; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 14px"> 13: }</pre></pre><p>对js中的call理解不深，便写了一段测试代码：</p><pre><pre style="background-color: #95f2a3; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 14px">  1: function each( object, callback ) {</pre><pre style="background-color: #9ca6fa; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 14px">  2:     if ( Array.isArray( object ) ) {</pre><pre style="background-color: #95f2a3; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 14px">  3:         for ( var i = 0; i &lt; object.length; i++ ) {</pre><pre style="background-color: #9ca6fa; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 14px">  4:             // callback.call( null, i, object[i] );  </pre><pre style="background-color: #95f2a3; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 14px">  5:             callback( i, object[i] );</pre><pre style="background-color: #9ca6fa; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 14px">  6:         }</pre><pre style="background-color: #95f2a3; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 14px">  7:     } </pre><pre style="background-color: #9ca6fa; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 14px">  8: }</pre></pre><p>两个函数都可以得到正确结果，那为什么还要使用call方法，使用call方法的好处在哪里。于是在MDN上找到一段代码示例，经常认真分析，让我对call的认识更深一层。</p><pre><pre style="background-color: #95f2a3; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 14px">  1: function Product(name, price) {  </pre><pre style="background-color: #9ca6fa; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 14px">  2:   this.name = name;  </pre><pre style="background-color: #95f2a3; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 14px">  3:   this.price = price;  </pre><pre style="background-color: #9ca6fa; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 14px">  4:   return this;  </pre><pre style="background-color: #95f2a3; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 14px">  5: }  </pre><pre style="background-color: #9ca6fa; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 14px">  6:   </pre><pre style="background-color: #95f2a3; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 14px">  7: function Food(name, price) {  </pre><pre style="background-color: #9ca6fa; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 14px">  8:   Product.call(this, name, price); </pre><pre style="background-color: #95f2a3; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 14px">  9:   this.category = 'food';  </pre><pre style="background-color: #9ca6fa; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 14px"> 10: }  </pre><pre style="background-color: #95f2a3; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 14px"> 11: Food.prototype = new Product();  </pre><pre style="background-color: #9ca6fa; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 14px"> 12:   </pre><pre style="background-color: #95f2a3; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 14px"> 13: function Toy(name, price) {  </pre><pre style="background-color: #9ca6fa; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 14px"> 14:   Product.call(this, name, price); </pre><pre style="background-color: #95f2a3; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 14px"> 15:   this.category = 'toy';  </pre><pre style="background-color: #9ca6fa; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 14px"> 16: }  </pre><pre style="background-color: #95f2a3; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 14px"> 17: Toy.prototype = new Product();  </pre><pre style="background-color: #9ca6fa; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 14px"> 18:   </pre><pre style="background-color: #95f2a3; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 14px"> 19: var cheese = new Food('feta', 5);  </pre><pre style="background-color: #9ca6fa; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 14px"> 20: var fun = new Toy('robot', 40); </pre><pre style="background-color: #95f2a3; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 14px"></pre></pre><p>是不是非常像C#中的继承关系呀，通过查看console，实例fun的属性都得到赋值。说明在调用call时，Product中的this就变成了fun，神奇吧，而C#中的函数就只能允许所在类调用，绝对不许为他所用！</p><p>PS：我一般习惯性地查MDN，网友franky建议查ES5，Mark！</p><p>ES5官方文档：http://es5.github.com/</p><p>MDN：https://developer.mozilla.org</p><pre>---end</pre>  <p>作者：清流鱼</p>  <p>出处：http://www.cnblogs.com/qingliuyu/</p>  <p>新浪微博：http://weibo.com/qingliuyu</p>  <p>本文版权归作者和博客园共有,欢迎转载,但未经作者同意必须保留此段声明,且在文章页面明显位置给出原文连接。</p>

了解破碎机常识：<a href='http://www.crushermillsupplier.com'>crusher mill supplier</a>