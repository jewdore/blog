---
layout: post
title: Android原理之动态墙纸 （转）
---

<p align="left">原贴地址：http://blog.csdn.net/sunchaoenter/article/details/7206293</p><p align="left">Livewallpaper，即动态墙纸，是Android的一大3D特色功能，用户可以在桌面选择加载动态墙纸，让自己的手机桌面背景旋动起来。</p><p align="left">相对于静态桌面壁纸，动态墙纸可以展示各种动态变化的背景，而与传统手机系统采用GIF作为动态背景不同的是，Android的动态墙纸并不是GIF图片，而是一个标准的Android应用程序，也就是APK。既然是应用程序，当然意味着天生具有有GIF图片不具备的功能&#8212;&#8212;能与用户发生交互，而且动态的背景变化绝不仅仅局限于GIF图片那般只能是固定的几张图片的循环播放。</p><p align="left">需要指出的是，标准的Android系统可以支持将动态的GIF图片设置为静态墙纸，但并不能将GIF图片动态的运行起来。也就是说，如果你将GIF图片作为静态墙纸，你只能看到一帧静态的图片，不能像很多其他系统的山寨机那样能够在桌面看到GIF图片动态效果。这种局限是Android的一大缺陷，这个缺陷是Android墙纸框架设计缺陷有关。当然了，既然你可以加载丰富类型的旋动的具有交互效果的Android动态墙纸，那么GIF图片的少许遗憾完全可以接受。</p><p align="left">Android内置的动态墙纸都是基于RenderScript实现的，RenderScript是Google用于Android的一种类C语言，其与C语言语言结构很类似，其对OpenGL的标准API进行了简单的封装，可以在运行时再加载RenderScript文件运行。也就是说，如果你想基于RenderScript开发新的动态墙纸，你应该对OpenGL的常用API有一定的了解。此外，Google目前对RenderScript的开发资料还不是很完善，在公开发布的SDK里也暂时没有把RenderScript继承进ADT，换言之，如果你想用RenderScript开发新动态墙纸，你不能基于ADT和SDK在Eclipse下进行开发，而应该下载完整源代码并编译整个框架，然后在自己的Linux编译环境里去写新应用。因为RenderScript是要调用OpenGL接口的，你开发的应用要能在真机上运行起来，你的机子必须支持3D，也就是OpenGL。如果你发现有的厂商的手机桌面并没有加载动态墙纸的入口，那么不用多说，那一定是该手机根本不支持3D，这一点对于想购买真机来学习Andoid开发的朋友来说就一定要当心了。</p><p align="left" sizset="31" sizcache="1">Google在发布的各个Android版本里都内置了一定数量的动态墙纸，各个版本的动态墙纸代码有少许差别，但是动态墙纸的名称、视效、个数基本都是一样的。下面我们看下这些动态墙纸的代码在什么位置。我们打开Google的Android源代码地址：http://android.git.kernel.org/</p><p align="left"></p><p align="left">https://github.com/android/following（这个可以用，非原贴）</p><p align="left" sizset="32" sizcache="1">可以看到，Android内置的动态墙纸都在packages/wallpapers/这个目录里，通过git clone方法（参见博文&#8220;Android源码下载&#8212;&#8212;用git clone实现单个目录下载&#8221;，http://blog.csdn.net/droidpioneer/article/details/6612026）快速的下载各个子目录各个Android版本的Android内置动态墙纸代码。其中，Basic、MusicVisualization两个目录里都包括了多个相同代码框架的多个动态墙纸，MagicSmoke目录只包含魔幻烟雾一个动态墙纸，LivePicker目录里包含的是动态墙纸的选择列表的代码，也就是你在桌面选择添加动态墙纸时出现的系统里所有动态墙纸的那个列表的实现代码。</p><p align="left" sizset="33" sizcache="1">那么，动态墙纸的本质是什么呢？前文已述，是APK，不过是比较特殊的APK。我们不妨打开MagicSomke的AndroidManifest.xml文件：</p>[html] view plaincopyprint?

了解破碎机常识：<a href='http://www.crushermillsupplier.com'>crusher mill supplier</a>