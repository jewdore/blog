---
layout: post
title: ruby应用如何选择mysql适配器
---

<p>rails2.2之前缺省安装mysql的驱动，之后缺省的已经变成sqlite3，如果与mysql连接，则需要自己选择安装。在学习开源系统的时候，发现有的rails3的应用直接使用的是mysql2 </p><p>在database.yml中直接是按照如下方式</p><p>development: adapter: mysql2 encoding: utf8 database: baseapp username: root password: host: localhost</p><p>在github查询之后，有一个三种ruby mysql 适配器的比较（三万行数据的遍历操作）：</p><pre>   user       system     total       real  Mysql2   0.750000   0.180000   0.930000 (  1.821655)  do_mysql   1.650000   0.200000   1.850000 (  2.811357)  Mysql   7.500000   0.210000   7.710000 (  8.065871)</pre><p>可见mysql2的性能要高出许多。</p><p>注：</p><p>在windows、linux环境下会出现如下错误：</p><p>Building native extensions. This could take a while...ERROR: Error installing mysql2: ERROR: Failed to build gem native extension.</p><p>。。。</p><p>1、windows的解决方案：将mysql安装目录下的bin下的libmysql.dll复制到 ruby安装目录/lib下即可；在系统</p><p>2、linux的解决方案：在系统中找两个文件：libmysqlclient.so，mysql.h所在的目录，假设分别是/a和/b,然后执行下面操作即可：</p><p>gem install mysql2 -- --with-mysql-lib=/a --with-mysql-include=/b</p><p><em><em><code>通过源代码安装mysql的一般都有这样的文件</code> </em> 如果没有，则需要到网上下载<em><code>libmysqlclient-dev</code> </em> <em><code>。</code> </em>   </em></p><p>今天遇到了新的问题：</p><p>ruby1.8.7,rails2.3.8，gem install mysql2之后，进入console状态时，老是提示</p><p>D:/ir3/ruby/lib/ruby/gems/1.8/gems/activerecord-2.3.8/lib/active_record/connection_adapters/abstract/connection_specification.rb:76:in `establish_connection':RuntimeError: Please install the mysql2 adapter: `gem install activerecord-mysql2-adapter` (no such file to load -- java)</p><p>这和Java有什么关系？</p><p>于是删除与jdbc相关的gem包，提示又变成如下：</p><p>D:/ir3/ruby/lib/ruby/gems/1.8/gems/activerecord-2.3.8/lib/active_record/connection_adapters/abstract/connection_specification.rb:76:in `establish_connection':RuntimeError: Please install the mysql2 adapter: `gem install activerecord-mysql2-adapter` (no such file to load -- active_record/connection_adapters/mysql2_adapter)</p><p>但是gem install activerecord-mysql2-adapter 根本不能使用，也就是没有这个gem包。</p><p>于是参照linux下的重新安装mysql2，将mysql目录添加；</p><p>gem install mysql2 -- --with-mysql-config=d:/ir3/mysql</p><p>安装成功后，执行ruby script/console,不再提示错误。</p><p>但是测试，查看类，键入User，返回正常；但是想查看一个记录，如User.first则出现&ldquo;ArgumentError: invalid date&rdquo;的错误。</p><p>嗨，在windows环境下，还是暂时回到mysql吧。</p><p>风之境地 java-javascript 蘑菇街女装</p>

了解破碎机常识：<a href='http://www.crushermillsupplier.com'>crusher mill supplier</a>