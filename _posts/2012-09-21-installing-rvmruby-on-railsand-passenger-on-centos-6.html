---
layout: post
title: Installing RVM, Ruby on Rails, and Passenger on Centos 6
---

<p>Installing RVM Multi-user on CentOS can be a bit tricky. Here's my documentation - mostly so I remember, but hopefully it helps someone else as well.</p><p>A quick note - the people behind RVM are clear that tutorials outside their siteare not supported. They're not discouraged, but they won't support them. Pretty reasonable. These directions worked for me, but you should understand what you're doing before following directions on the internet.</p><p>My install was for Ruby 1.9.3 (current at the time of writing) on CentOS 6.2 x86_64. I installed on a VMware Fusion virtual machine. I'll be installing this on an EC2 instance in the future - I don't expect much in the way of changes, but will update if needed. I'll also be assuming a minimal install. As this was for a local devel environment I did a few things I wouldn't suggest doing on a production or publicly available site. I want to use Apache and a local MySQL instance, so I'll be installing those as well.</p><p>Ok, with that out of the way:</p><p>First, as root:</p><p><code>yum update</code></p><p><code>yum -y groupinstall "Development Tools"</code></p><p><code>yum -y install ntp</code></p><p><code>ntpdate pool.ntp.org</code></p><p><code>yum -y install zlib zlib-devel sqlite-devel httpd mysql-server mysql-devel curl-devel httpd-devel apr-devel apr-util-devel mlocate manlibxml2-devellibxslt-devel libffi-devel readline-devel</code></p><p><code>adduser your_name</code></p><p><code>passwd your_name</code></p><p><code>usermod -G wheel your_name</code></p><p>The last step in this section is to run <code>visudo</code>. Uncomment the line <code>%wheel ALL=(ALL) NOPASSWD:ALL</code> towards the bottom of the file.</p><p>Now logout and log back in as your_name.</p><p class="p1"><code>sudo bash -s stable &lt; &lt;(curl -s </code>https://raw.github.com/wayneeseguin/rvm/master/binscripts/rvm-installer )</p><p class="p1"><code>logout</code></p><p class="p1"></p><p class="p1">Now back to root and run</p><p class="p1"><code>usermod -G wheel,rvm your_name</code></p><p class="p1">and log back out.</p><p class="p1"></p><p class="p1">Now we're getting somewhere. RVM is installed and we're about ready to install ruby. Let's do a couple of sanity checks first.</p><p class="p1">Log in as your_name.</p><p class="p1"><code>which rvm</code></p><p class="p1">As a multi-site install RVM should have been installed to <code>/usr/local/rvm</code>.</p><p class="p1">Next,</p><p class="p1"><code>type rvm |head -1</code></p><p class="p1">should return</p><p class="p1"><code>rvm is a function</code>.</p><p class="p1">OK, we've successfully installed RVM. Now let's install Ruby. We'll include an openssl directive so we can install Passenger in a bit. Still as your_name:</p><p class="p1"><code>rvm install 1.9.3 --with-openssl-dir=/usr</code></p><p class="p1">Now let's set the default version:</p><p class="p1"><code>rvm use 1.9.3 --default</code></p><p class="p1">And finally:</p><p class="p1"><code>gem install rake</code></p><p class="p1"><code>gem install rails</code></p><p class="p1">Now rake and rails are installed. Let's install passenger (and a few gems for database connectivity).</p><p><code>gem install mysql2 sqlite3 passenger</code></p><p>OK, now to set up passenger for Apache:</p><p><code>passenger-install-apache2-module</code></p><p>Pay attention to the paths that the install script gives you at the end. Copy them to a text file somewhere - we'll need them in a bit.</p><p>Now let's configure Apache.</p><p>I like the way Ubuntu lays out the Apache config - especially virtual hosts - so we'll mimic that here.</p><p><code>sudo mkdir /etc/httpd/sites-available</code></p><p><code>sudo mkdir /etc/httpd/sites-enabled</code></p><p>We'll also need a few virtual host specific folders:</p><p><code>sudo mkdir /var/www/application_name</code></p><p><code>sudo mkdir /var/log/httpd/application_name</code></p><p>Now that our folder layout is set, let's get to the actual configuration files:</p><p>First up, passenger. Let's create a passenger.conf file and paste in the paths we saved previously:</p><p><code>sudo vi /etc/httpd/conf.d/passenger.conf</code></p><p class="p1">and populate</p><p class="p1"><code>LoadModule passenger_module /usr/local/rvm/gems/ruby-1.9.3-p0/gems/passenger-3.0.11/ext/apache2/mod_passenger.so</code></p><p class="p1"><code>PassengerRoot /usr/local/rvm/gems/ruby-1.9.3-p0/gems/passenger-3.0.11</code></p><p class="p1"><code>PassengerRuby /usr/local/rvm/wrappers/ruby-1.9.3-p0/ruby</code></p><p class="p1"></p><p>Save the file. This will load the passenger module when Apache starts.</p><p>Next let's set up the virtual hosts:</p><p><code>sudo vi /etc/httpd/sites-available/application_name.conf</code></p><p><code>&lt;VirtualHost *:80&gt;</code></p><p><code> ServerAdmin youremail@example.com</code></p><p><code> DocumentRoot /var/www/application_name/public</code></p><p><code> ServerName yourservername</code></p><p><code> ErrorLog /var/log/httpd/application_name/error.log</code></p><p><code> CustomLog /var/log/httpd/application_name/access.log common</code></p><p><code>&lt;/VirtualHost&gt;</code></p><p>It's important to note we're pointing the DocumentRoot to /public of your application.</p><p>Now let's tell Apache where to look for the virtual host definitions:</p><p><code>sudo vi /etc/httpd/conf/http.conf</code></p><p>Towards the bottom add:</p><p><code>Include sites-enabled/*.conf</code></p><p>Save the file.</p><p>Two more steps and we're there.</p><p>First link the virtual host definition to sites-enabled</p><p><code>sudo ln -s /etc/httpd/sites-available/application_name.conf /etc/httpd/sites-enabled/application_name.conf</code></p><p>Second, we need to suspend SELinux:</p><p><code>sudo setenforce 0</code></p><p>I would absouletly, positively run SELinux on a publicly facing website. Spend some time to learn to configure it - it's not nearly as scary as it looks at first.</p><p>Go ahead and deploy your application to<code style="font-size: 13px;">/var/www/application_name.</code>Finally, start apache to make sure it runs <code>sudo service httpd start</code>.</p><p>That's it. You should be able to visit your site at http://yourservername.</p>

了解破碎机常识：<a href='http://www.crushermillsupplier.com'>crusher mill supplier</a>