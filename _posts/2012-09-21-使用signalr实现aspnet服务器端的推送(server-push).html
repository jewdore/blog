---
layout: post
title: 使用SignalR实现asp.net服务器端的推送(Server Push)
---

<p>我们在开发Web应用时，有时候需要将Server端的的信息Push到客户端。常见的一个场景就是微博应用，需要将一个用户的收听实时消息推送到Web端，也就是用户的更新用户的Timeline。</p>  <p>对此通用的解决方案就是Long Polling——支持XMLHttpRequest的浏览器都可以使用，使得其适用范围广。对此需要注意的就是Server端的处理能力，最好能用类似Node.js的Non-Block式的并发。GitHub有个项目SignalR使得的在asp.net中实现Server Side的Push变得简单。为了使用SignalR，我们需要在NuGet中搜索SignalR并安装。</p>  <p>安装完成后我们便可以使用SignalR了，我们先看Client端的实现：</p>  <pre class="brush: html;">&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"&gt;&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;&lt;head runat="server"&gt;    &lt;title&gt;Welcome to Microblog&lt;/title&gt;    &lt;script src="../Scripts/jquery-1.6.4.js" type="text/javascript"&gt;&lt;/script&gt;    &lt;script src="../Scripts/jquery.signalR.js" type="text/javascript"&gt;&lt;/script&gt;    &lt;script src="../signalr/hubs"&gt;&lt;/script&gt;&lt;/head&gt;&lt;body&gt;    &lt;form id="form1" runat="server"&gt;    &lt;div&gt;        &lt;div&gt;            &lt;span&gt;MicroBlog ID:&lt;/span&gt;&lt;input type="text" id="uid" name="uid" value=" " /&gt;            &lt;input type="button" name="refreshTimeline" id="refreshTimeline" value="Refresh Timeline" /&gt;        &lt;/div&gt;        &lt;ul id="messages"&gt;&lt;/ul&gt;    &lt;/div&gt;    &lt;/form&gt;    &lt;script type="text/javascript"&gt;        $(function () {            // Proxy created on the fly            var conn = $.connection.microBlogServer;            // Declare a function so the server can invoke it            conn.newMessage = function (msg) {                $('#messages').append('&lt;li&gt;' + msg + '&lt;/li&gt;');            };            conn.notify = function(notice) {                $('#messages').append('&lt;li&gt;[system notice]:\t' + notice + '&lt;/li&gt;');            }            // Start the connection            $.connection.hub.start();            //call server side refresh when all things ready            $("#refreshTimeline").click(function() {                conn.refreshTimeline($('#uid').val());            });        });    &lt;/script&gt;&lt;/body&gt;&lt;/html&gt;</pre>

了解破碎机常识：<a href='http://www.crushermillsupplier.com'>crusher mill supplier</a>